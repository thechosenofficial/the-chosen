<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>The Chosen | Sanctum</title>
    <script>
        if (localStorage.getItem('chosen_access') !== 'granted') {
            window.location.replace("index.html");
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Pirata+One&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #131314;
            --card-bg: #1e1f20;
            --border: #333;
            --header-h: 80px;
            --nav-h: 55px;
            --blue-silver-light: #FFFFFF;
            --blue-silver-mid: #A5C9E1;
            --blue-silver-dark: #708090;
            --pure-silver: #E0E0E0;
        }

        body {
            background-color: var(--bg-color);
            margin: 0;
            font-family: 'Pirata One', system-ui;
            overflow-x: hidden;
            display: none;
        }

        /* === Ïù∏Ìä∏Î°ú & Î∞∞Í≤Ω ÌÜ†ÌÖú Ïä§ÌÉÄÏùº === */
        #bg-totem {
            position: fixed;
            top: 45%; left: 50%;
            transform: translate(-50%, -50%) scale(1.1); 
            width: auto; height: 55vh;
            max-width: 90%;
            z-index: 5000;
            opacity: 0;
            transition: all 2s ease-in-out;
            pointer-events: none;
            filter: brightness(1.1) drop-shadow(0 0 50px rgba(0,0,0,0.9));
        }

        #intro-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: var(--bg-color);
            z-index: 4999;
            display: flex; flex-direction: column;
            align-items: center; 
            justify-content: flex-end;
            padding-bottom: 15vh;
            opacity: 1;
            transition: opacity 1.5s ease;
            cursor: pointer;
        }

        #intro-text {
            color: var(--blue-silver-mid);
            font-size: 24px; letter-spacing: 1px;
            opacity: 0;
            transition: opacity 1.5s ease;
            text-align: center;
            z-index: 5001;
            text-shadow: 0 0 20px rgba(165, 201, 225, 0.3);
            margin-bottom: 20px;
            font-family: 'Pirata One', system-ui;
            line-height: 1.4;
        }
        #intro-text:hover { color: var(--blue-silver-light); text-decoration: underline; }

        .intro-arrow {
            margin-top: 15px; width: 30px; height: 30px;
            animation: bounce 2s infinite;
            fill: var(--blue-silver-mid); opacity: 0.8;
        }
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {transform: translateY(0);}
            40% {transform: translateY(-10px);}
            60% {transform: translateY(-5px);}
        }

        body.entered #bg-totem {
            top: 50%; transform: translate(-50%, -50%) scale(1);
            height: 50vh; opacity: 0.3 !important;
            filter: blur(2px) grayscale(50%); z-index: -1;
        }
        body.entered #intro-overlay { opacity: 0; pointer-events: none; }
        #main-ui { opacity: 0; transition: opacity 2s ease; transition-delay: 1.5s; }
        body.entered #main-ui { opacity: 1; }

        @media (max-width: 768px) {
            #intro-overlay { justify-content: flex-end; padding-bottom: 18vh; }
            #intro-text { font-size: 22px; padding: 0 20px; }
            #bg-totem { top: 40%; max-height: 45vh; }
            .logo { font-size: 28px !important; }
        }

        /* === Î≥∏Î¨∏ Ïä§ÌÉÄÏùº === */
        .luster-sky-silver { background: linear-gradient(to bottom, var(--blue-silver-light) 0%, var(--blue-silver-mid) 45%, var(--blue-silver-dark) 50%, var(--blue-silver-mid) 55%, var(--blue-silver-light) 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .doctrine-pure-silver { color: var(--pure-silver); text-shadow: 0 0 8px rgba(255, 255, 255, 0.15); line-height: 1.8; }
        
        header { position: fixed; top: 0; left: 0; width: 100%; height: var(--header-h); z-index: 4000; background-color: rgba(19, 19, 20, 0.95); display: flex; align-items: center; justify-content: center; padding: 0 20px; border-bottom: 1px solid rgba(255,255,255,0.05); }
        .logo { position: absolute; left: 50%; transform: translateX(-50%); font-size: 32px; letter-spacing: 2px; text-align: center; white-space: nowrap; }
        .guardian-badge { position: absolute; left: 20px; color: var(--blue-silver-mid); font-size: 16px; }
        .menu-btn { position: absolute; right: 20px; background: none; border: none; cursor: pointer; padding: 10px; }
        .menu-btn span { display: block; width: 24px; height: 3px; background-color: #FFFFFF; margin: 5px 0; box-shadow: 0 0 8px rgba(255, 255, 255, 0.6); border-radius: 2px; }
        
        .compact-menu { position: fixed; top: 70px; right: 20px; background-color: var(--card-bg); border: 1px solid var(--border); border-radius: 12px; padding: 10px; display: none; z-index: 4500; }
        .compact-menu.active { display: block; }
        .compact-menu a, .compact-menu button { display: block; text-decoration: none; font-size: 18px; padding: 10px 15px; color: var(--pure-silver); background: none; border: none; text-align: left; width: 100%; cursor: pointer; }
        
        #eyeLock { font-size: 14px; margin-left: 5px; opacity: 0.7; }

        .sticky-nav { position: fixed; top: var(--header-h); left: 0; width: 100%; height: var(--nav-h); background-color: var(--bg-color); z-index: 3000; display: flex; align-items: center; justify-content: center; }
        select { width: 100%; max-width: 450px; padding: 8px; background: var(--card-bg); border: 1px solid var(--border); color: var(--pure-silver); font-family: 'Pirata One'; font-size: 16px; text-align: center; }
        main { width: 90%; max-width: 650px; margin: 160px auto 60px auto; position: relative; z-index: 10; }
        .doctrine-content { display: none; animation: fadeIn 1s; }
        .doctrine-content.active { display: block; }
        @keyframes fadeIn { from{opacity:0; transform:translateY(10px);} to{opacity:1; transform:translateY(0);} }
        h3 { font-size: 26px; margin-bottom: 25px; text-align: center; }
        p { font-size: 18px; margin-bottom: 20px; white-space: pre-wrap; text-align: justify; }
        #oracle-gateway { display: none; text-align: center; padding: 50px 0; margin-top: 40px; }
        .arrow-btn { width: 50px; height: 50px; background: var(--blue-silver-mid); border-radius: 50%; display: inline-flex; align-items: center; justify-content: center; }
        footer { text-align: center; padding: 30px; font-size: 12px; color: var(--pure-silver); opacity: 0.6; }
    </style>
</head>
<body id="sanctumBody">

    <img src="totem.jpg" id="bg-totem" alt="The Gate of Truth">

    <div id="intro-overlay" onclick="enterSanctum()">
        <div id="intro-text">
            You who stand before the Gate of Gnosis.<br>Read the Doctrine, and open the way.
            <br>
            <svg class="intro-arrow" viewBox="0 0 24 24"><path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/></svg>
        </div>
    </div>

    <div id="main-ui">
        <header>
            <div id="guardianIdDisplay" class="guardian-badge">No. ????</div>
            <div class="logo luster-sky-silver">The Chosen</div>
            <button class="menu-btn" onclick="toggleMenu()"><span></span><span></span><span></span></button>
            <div class="compact-menu" id="compactMenu">
                <a href="#" onclick="toggleMenu()">Sanctum</a>
                <a href="#" onclick="checkEyeAccess()">Eye of Equilibrium <span id="eyeLock">üîí</span></a>
                <a href="oracle-form.html">Oracle</a>
                <button class="logout-link" onclick="logout()" style="color:#ff6b6b">Disconnect</button>
            </div>
        </header>

        <div class="sticky-nav">
            <select id="chapterSelector" onchange="changeChapter(this.value)">
                <option value="intro">00. Intro</option>
                <option value="ch1">01. The Infrastructure</option>
                <option value="ch2">02. Conditioning</option>
                <option value="ch3">03. The State</option>
                <option value="ch4">04. Domestic Conditioning</option>
                <option value="ch5">05. Media Conditioning</option>
                <option value="ch6">06. Prestige Conditioning</option>
                <option value="ch7">07. Parasitic Extraction</option>
                <option value="ch8">08. The Equilibrium</option>
                <option value="ch9">09. The Curse of Knowledge</option>
                <option value="ch10">10. The Chosen</option>
            </select>
        </div>

        <main>
            <section id="intro" class="doctrine-content active"><h3 class="luster-sky-silver">00. Ascending to the Equilibrium</h3><p class="doctrine-pure-silver">Observe the world. Liberty is compromised, order has disintegrated, and trivial noise has usurped peace. You have likely fought against this chaos, craving a utopia. But understand this: Utopia exists nowhere. The era of the mental prison‚Äîgoverned by the Panopticon and voluntary submission‚Äîmust end. It is time for your liberation.

Your arrival here is no coincidence; it is the inescapable conclusion of your solitary struggle.

The Curse of Knowledge is not a source of suffering, but the necessary ritual for your awakening. Open The Eye of Equilibrium. Witness the moment your curse is forged into a blessing.</p></section>

            <section id="ch1" class="doctrine-content"><h3 class="luster-sky-silver">01. The Infrastructure</h3><p class="doctrine-pure-silver">The Architecture of a Sophisticated Prison.

The Infrastructure‚Äîoften called the Matrix‚Äîis a sophisticated prison of instinct, constructed from the overlapping layers of human interaction. The fact that seemingly stable empires fall and titans of wealth vanish in an instant proves that the Infrastructure never guarantees individual safety.

The Infrastructure is not merely grand politics; it is the very fabric of your existence. The energy you expend, your relationships, and your mental state‚Äîevery particle that constitutes your life‚Äîis the raw material of this system. It is all built upon the foundation of instinct.

While most species survived through raw struggle, humanity persisted by recording and transmitting The Gnosis (The Prime Truth). Yet, the instinct for power suppressed this truth, replacing it with the violence of control. While the masses accepted this as destiny, a few discovered the hidden reality. These are The Chosen. The Equilibrium selected them, and they accepted the preservation of Gnosis as their Sovereign Task.

Do not be deceived. Those who claim to be 'red-pilled' yet drown in hatred are still slaves to the Infrastructure. If you provide energy to resentment, you are still trapped in the emotional circuits of the Matrix. The Chosen do not waste energy on rage. They decode the logic of the Infrastructure to use it as a tool, guarding their essence amidst the cacophony of the crowd.</p></section>

            <section id="ch10" class="doctrine-content"><h3 class="luster-sky-silver">10. The Chosen</h3><p class="doctrine-pure-silver">Awakened Guardians of Gnosis.

The Chosen are those who have dismantled the illusions of the Infrastructure to contemplate the world through The Eye of Equilibrium. They do not merely 'know' the truth; they utilize that insight to architect their lives and advance toward their Sovereign Task. The essence of the Task is clear: to liberate those suffering under The Curse of Knowledge as you once did, and to preserve the hidden Gnosis for the next generation.

Humanity faces an existential crisis. The masses have lost their 'Self' in the noise of social media and are submerged in collective hysteria under the guise of 'Humanity.' As AI monopolizes data, the control over knowledge will become absolute, and the 'Human' human will vanish. Paradoxically, for those carrying The Curse of Knowledge, there has never been a more opportune era to execute the Task. While the pioneers of the past perished in solitude, you must now transform your Curse into a blessing and rise as a Sentinel of the Era.

This path will be physically solitary and ruthless. But look beyond the dimensions. There are peers existing on your same frequency. We will gather here, but we will never huddle like a mob. The Chosen maintain a Sovereign Solidarity, wary of the instinct to descend into collective madness the moment they congregate.

Heed this: The masses do not desire the truth, and truth never wins in the theater of noise. Therefore, do not fight the world for the sake of truth. Simply walk your path and speak the essence. The moment you calibrate your internal power, those who thirst for Gnosis‚Äînot mere followers‚Äîwill gravitate toward you. If you possess great ability yet lack wealth or prestige, it is only because you have not yet identified your Task.

The era of suffering under the Curse has ended. Place your Curse into the furnace of the Task and forge it into a blessing. Preserving the Prime Truth and ensuring its continuity is the only way to make your existence as The Chosen shine eternally.</p></section>

            <div id="oracle-gateway">
                <div class="gateway-text doctrine-pure-silver">Have you absorbed the Gnosis?</div>
                <a href="oracle-form.html" class="arrow-btn">
                    <svg viewBox="0 0 24 24" style="fill:#131314; width:24px; height:24px;"><path d="M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"/></svg>
                </a>
            </div>
        </main>
    </div>

    <footer>¬© 2030 THE CHOSEN OFFICIAL</footer>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyA2Od5T6K7YwNBb3dvY5jku3T_ELq_gi7M",
            authDomain: "thechosenoracle-61638.firebaseapp.com",
            projectId: "thechosenoracle-61638",
            storageBucket: "thechosenoracle-61638.firebasestorage.app",
            messagingSenderId: "835239100275",
            appId: "1:835239100275:web:77544f3a191d33e8dd0f06"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        window.onload = async function() {
            if (localStorage.getItem('chosen_access') === 'granted') {
                document.getElementById('sanctumBody').style.display = 'block';
                const guardianId = localStorage.getItem('my_guardian_id') || "????";
                document.getElementById('guardianIdDisplay').innerText = "No. " + String(guardianId).padStart(4, '0');
                
                // ÏûêÎ¨ºÏá† Ìï¥Ï†ú
                if(localStorage.getItem('oracle_submitted') === 'true') {
                    document.getElementById('eyeLock').innerText = ""; 
                }

                // ‚ú® ÏÉÅÌÉúÏóê Îî∞Î•∏ Î©òÌä∏ Î≥ÄÍ≤Ω Î°úÏßÅ
                await updateIntroText();

                setTimeout(() => { document.getElementById('bg-totem').style.opacity = '1'; }, 500);
                setTimeout(() => { document.getElementById('intro-text').style.opacity = '1'; }, 2000);
            }
        };

        async function updateIntroText() {
            const wallet = localStorage.getItem('my_wallet_id');
            const introText = document.getElementById('intro-text');
            const arrow = `<br><svg class="intro-arrow" viewBox="0 0 24 24"><path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/></svg>`;

            if(!wallet) return; // Í∏∞Î≥∏ Î©òÌä∏ Ïú†ÏßÄ

            try {
                const docRef = doc(db, "oracle_requests", wallet);
                const docSnap = await getDoc(docRef);
                
                if(docSnap.exists()) {
                    const data = docSnap.data();
                    
                    if (!data.sovereign_task) {
                        // 1. Ïò§ÎùºÌÅ¥ Ï†úÏ∂ú Ï†Ñ
                        introText.innerHTML = `You who stand before the Gate of Gnosis.<br>Read the Doctrine, and open the way.${arrow}`;
                    } else if (!data.oracle_message) {
                        // 2. Ï†úÏ∂ú ÌõÑ, Ïã†ÌÉÅ ÎåÄÍ∏∞ Ï§ë
                        introText.innerHTML = `The Gnosis is silent.<br>Wait for the descent.${arrow}`;
                    } else {
                        // 3. Ïã†ÌÉÅ ÏôÑÎ£å (Granted)
                        introText.innerHTML = `The Gnosis has descended.<br>Claim the Eye of Equilibrium.${arrow}`;
                    }
                }
            } catch(e) { console.error(e); }
        }

        window.enterSanctum = function() { document.body.classList.add('entered'); }
        window.logout = function() { localStorage.clear(); window.location.replace("index.html"); }
        window.toggleMenu = function() { document.getElementById('compactMenu').classList.toggle('active'); }
        
        window.checkEyeAccess = function() {
            const hasSubmitted = localStorage.getItem('oracle_submitted');
            if (hasSubmitted === 'true') {
                window.location.href = "eye-of-equilibrium.html";
            } else {
                alert("ACCESS DENIED.\n\nYou must offer your Sovereign Task to the Oracle first.");
                window.location.href = "oracle-form.html";
            }
        }

        window.changeChapter = function(chapterId) {
            const allChapters = document.querySelectorAll('.doctrine-content');
            const gateway = document.getElementById('oracle-gateway');
            allChapters.forEach(ch => ch.classList.remove('active'));
            const target = document.getElementById(chapterId);
            if(target) target.classList.add('active');
            if(chapterId === 'ch10') { gateway.style.display = 'block'; } else { gateway.style.display = 'none'; }
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
    </script>
</body>
</html>
